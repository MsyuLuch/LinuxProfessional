# **Ð”Ð¾Ð¼Ð°ÑˆÐ½ÐµÐµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ â„–27**

ðŸ”–Ð”Ð¾Ð¼Ð°ÑˆÐ½ÐµÐµ Ð·Ð°Ð´Ð°Ð½Ð¸Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ Ð´Ð»Ñ ÐºÑƒÑ€ÑÐ° [Administrator Linux.Professional](https://otus.ru/lessons/linux-professional/)

## **Ð ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ MySQL**
 
Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ñ‹ ÑÑ‚ÐµÐ½Ð´Ð°:

Ð’ Ð¼Ð°Ñ‚ÐµÑ€Ð¸Ð°Ð»Ð°Ñ… Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ñ‹ ÑÑÑ‹Ð»ÐºÐ¸ Ð½Ð° Vagrantfile (https://gitlab.com/otus_linux/stands-mysql/-/tree/master/) Ð´Ð»Ñ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¸ Ð´Ð°Ð¼Ð¿ Ð±Ð°Ð·Ñ‹ bet.dmp.

Ð‘Ð°Ð·Ñƒ Ñ€Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð½Ð° Ð¼Ð°ÑÑ‚ÐµÑ€Ðµ Ð¸ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ Ñ‚Ð°Ðº, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ñ€ÐµÐ¿Ð»Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð»Ð¸ÑÑŒ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹: bookmaker, competition, market, odds, outcome.
ÐÐ°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ GTID Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸ÑŽ. 

Ð¤Ð¾Ñ€Ð¼Ð°Ñ‚ ÑÐ´Ð°Ñ‡Ð¸ Ð”Ð— - vagrant + ansible

# **Ð˜ÑÑ…Ð¾Ð´Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ**

Ð—Ð´ÐµÑÑŒ:
- `readme.md` - Ð¾Ð¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð´Ð¾Ð¼Ð°ÑˆÐ½ÐµÐ³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ
- `Vagrantfile` - Ñ„Ð°Ð¹Ð» Ð¾Ð¿Ð¸ÑÑ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð²Ð¸Ñ€Ñ‚ÑƒÐ°Ð»ÑŒÐ½ÑƒÑŽ Ð¸Ð½Ñ„Ñ€Ð°ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ð´Ð»Ñ `Vagrant`

# **ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ†ÐµÑÑÐ° Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¸Ñ Ð´Ð¾Ð¼Ð°ÑˆÐ½ÐµÐ³Ð¾ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ â„–27**

Ð ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð¾Ð·Ð²Ð¾Ð»ÑÐµÑ‚ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ Ð¾Ð´Ð½Ð¾Ð³Ð¾ ÑÐµÑ€Ð²ÐµÑ€Ð° Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… MySQL (Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ°) Ð½Ð° Ð¾Ð´Ð¸Ð½ Ð¸Ð»Ð¸ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð² Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… MySQL (Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ¸). 
Ð ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ñ Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð°ÑÐ¸Ð½Ñ…Ñ€Ð¾Ð½Ð½Ð°; Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ð¼ Ð½Ðµ Ñ‚Ñ€ÐµÐ±ÑƒÐµÑ‚ÑÑ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ðµ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹ Ð¸Ð· Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ°. 
Ð’ Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸ Ð¾Ñ‚ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¸ Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ñ€ÐµÐ¿Ð»Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð²ÑÐµ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…, Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ð±Ð°Ð·Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð¸Ð»Ð¸ Ð´Ð°Ð¶Ðµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð² Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ….

ÐŸÑ€ÐµÐ¸Ð¼ÑƒÑ‰ÐµÑÑ‚Ð²Ð° Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð² MySQL Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚ Ð² ÑÐµÐ±Ñ:

- ÐœÐ°ÑÑˆÑ‚Ð°Ð±Ð¸Ñ€ÑƒÐµÐ¼Ñ‹Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ñ â€” Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð½Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ Ð¼ÐµÐ¶Ð´Ñƒ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ð¼Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð²Ñ‹ÑˆÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸. Ð’ ÑÑ‚Ð¾Ð¹ ÑÑ€ÐµÐ´Ðµ Ð²ÑÐµ Ð·Ð°Ð¿Ð¸ÑÐ¸ Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð½Ð° Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ðµ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸. ÐžÐ´Ð½Ð°ÐºÐ¾ Ñ‡Ñ‚ÐµÐ½Ð¸Ðµ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð½Ð° Ð¾Ð´Ð½Ð¾Ð¹ Ð¸Ð»Ð¸ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ñ… Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ…. Ð­Ñ‚Ð° Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹ Ð·Ð°Ð¿Ð¸ÑÐ¸ (Ð¿Ð¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸Ðº Ð¿Ñ€ÐµÐ´Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ð´Ð»Ñ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¹), Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ ÑÐºÐ¾Ñ€Ð¾ÑÑ‚ÑŒ Ñ‡Ñ‚ÐµÐ½Ð¸Ñ Ð¿Ñ€Ð¸ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ð¸ Ñ‡Ð¸ÑÐ»Ð° Ñ€ÐµÐ¿Ð»Ð¸Ðº.

- Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ Ð´Ð°Ð½Ð½Ñ‹Ñ… â€” Ð¿Ð¾ÑÐºÐ¾Ð»ÑŒÐºÑƒ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ€ÐµÐ¿Ð»Ð¸Ñ†Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð² Ñ€ÐµÐ¿Ð»Ð¸ÐºÑƒ, Ð° Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ° Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¸Ð¾ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸, Ð¼Ð¾Ð¶Ð½Ð¾ Ð·Ð°Ð¿ÑƒÑÐºÐ°Ñ‚ÑŒ ÑÐ»ÑƒÐ¶Ð±Ñ‹ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð³Ð¾ ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð½Ð° Ñ€ÐµÐ¿Ð»Ð¸ÐºÐµ Ð±ÐµÐ· Ð¿Ð¾Ð²Ñ€ÐµÐ¶Ð´ÐµÐ½Ð¸Ñ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰Ð¸Ñ… Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ñ… Ð´Ð°Ð½Ð½Ñ‹Ñ….

- ÐÐ½Ð°Ð»Ð¸Ñ‚Ð¸ÐºÐ° â€” Ð¾Ð¿ÐµÑ€Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑÐ¾Ð·Ð´Ð°Ð½Ñ‹ Ð² Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐµ, Ð° Ð°Ð½Ð°Ð»Ð¸Ð· Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð² Ñ€ÐµÐ¿Ð»Ð¸ÐºÐµ, Ð½Ðµ Ð²Ð»Ð¸ÑÑ Ð½Ð° Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐ°.

- Ð Ð°ÑÐ¿Ñ€Ð¾ÑÑ‚Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð½Ð° Ð±Ð¾Ð»ÑŒÑˆÐ¸Ðµ Ñ€Ð°ÑÑÑ‚Ð¾ÑÐ½Ð¸Ñ â€” Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸ÑŽ Ð´Ð»Ñ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð»Ð¾ÐºÐ°Ð»ÑŒÐ½Ð¾Ð¹ ÐºÐ¾Ð¿Ð¸Ð¸ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸Ñ Ð½Ð° ÑƒÐ´Ð°Ð»ÐµÐ½Ð½Ð¾Ð¼ ÑÐ°Ð¹Ñ‚Ðµ Ð±ÐµÐ· Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° Ðº Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÑƒ.

Ð”Ð»Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¸ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹ ÑÑ‚ÐµÐ½Ð´Ð° Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÐ¼ `Vagrantfile`, Ð·Ð°Ñ…Ð¾Ð´Ð¸Ð¼ Ð½Ð° master Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼:
```
SHOW MASTER STATUS\G
```

Ð½Ð° replica:
```
SHOW SLAVE STATUS\G;
```

![MASTER](https://github.com/MsyuLuch/LinuxProfessional/blob/main/homework-27/images/master.png)
![REPLICA](https://github.com/MsyuLuch/LinuxProfessional/blob/main/homework-27/images/replica.png)

***Ð£ÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ° MYSQL***

Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ MySQL Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ ÑÐµÑ€Ð²ÐµÑ€ Ð¸ Ñ€ÐµÐ¿Ð»Ð¸ÐºÑƒ:
```
sudo yum install https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm 
sudo yum install mysql-community-server
```

ÐŸÐ¾ÑÐ»Ðµ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐ¸ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñƒ, Ñ‡Ñ‚Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚ÑŒ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ root Ð¸ Ð¿Ð¾Ð²Ñ‹ÑÐ¸Ñ‚ÑŒ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ ÑÐµÑ€Ð²ÐµÑ€Ð°:
```
mysql_secure_installation
```

Ð”Ð¾Ð±Ð°Ð²Ð¸Ð¼ Ð² Ð´Ð¾Ð¼Ð°ÑˆÐ½ÑŽÑŽ Ð¿Ð°Ð¿ÐºÑƒ root Ñ„Ð°Ð¹Ð» `my.cnf` Ñ Ð»Ð¾Ð³Ð¸Ð½Ð¾Ð¼ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÐµÐ¼:
```
[client]
user="root"
password="Replication2022#"
```

***ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° MASTER***

Ð“Ð»Ð¾Ð±Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ (GTID) â€” ÑÑ‚Ð¾ ÑƒÐ½Ð¸ÐºÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€, ÑÐ¾Ð·Ð´Ð°Ð½Ð½Ñ‹Ð¹ Ð¸ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ð¹ Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸ÐµÐ¹, 
ÑÐ¾Ð²ÐµÑ€ÑˆÐµÐ½Ð½Ð¾Ð¹ Ð½Ð° Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ðµ (Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐµ). Ð­Ñ‚Ð¾Ñ‚ Ð¸Ð´ÐµÐ½Ñ‚Ð¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ ÑƒÐ½Ð¸ÐºÐ°Ð»ÐµÐ½ Ð½Ðµ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð´Ð»Ñ ÑÐµÑ€Ð²ÐµÑ€Ð°, Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð¾Ð½ Ð±Ñ‹Ð» ÑÐ¾Ð·Ð´Ð°Ð½, Ð½Ð¾ Ð¸ Ð´Ð»Ñ Ð²ÑÐµÑ… ÑÐµÑ€Ð²ÐµÑ€Ð¾Ð² 
Ð² Ð´Ð°Ð½Ð½Ð¾Ð¹ Ñ‚Ð¾Ð¿Ð¾Ð»Ð¾Ð³Ð¸Ð¸ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸.

ÐšÐ¾Ð³Ð´Ð° ÐºÐ»Ð¸ÐµÐ½Ñ‚ÑÐºÐ°Ñ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ñ„Ð¸ÐºÑÐ¸Ñ€ÑƒÐµÑ‚ÑÑ Ð² Ð¸ÑÑ‚Ð¾Ñ‡Ð½Ð¸ÐºÐµ, ÐµÐ¹ Ð¿Ñ€Ð¸ÑÐ²Ð°Ð¸Ð²Ð°ÐµÑ‚ÑÑ Ð½Ð¾Ð²Ñ‹Ð¹ GTID Ð¿Ñ€Ð¸ ÑƒÑÐ»Ð¾Ð²Ð¸Ð¸, Ñ‡Ñ‚Ð¾ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ñ Ð±Ñ‹Ð»Ð° Ð·Ð°Ð¿Ð¸ÑÐ°Ð½Ð° Ð² Ð´Ð²Ð¾Ð¸Ñ‡Ð½Ñ‹Ð¹ Ð¶ÑƒÑ€Ð½Ð°Ð». 
ÐšÐ»Ð¸ÐµÐ½Ñ‚ÑÐºÐ¸Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ð¾ Ð¸Ð¼ÐµÑŽÑ‚ Ð¼Ð¾Ð½Ð¾Ñ‚Ð¾Ð½Ð½Ð¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°ÑŽÑ‰Ð¸Ðµ GTID Ð±ÐµÐ· Ð¿Ñ€Ð¾Ð±ÐµÐ»Ð¾Ð² Ð¼ÐµÐ¶Ð´Ñƒ ÑÐ³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ñ‡Ð¸ÑÐ»Ð°Ð¼Ð¸. 

Ð ÐµÐ¿Ð»Ð¸Ñ†Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ ÑÐ¾Ñ…Ñ€Ð°Ð½ÑÑŽÑ‚ Ñ‚Ð¾Ñ‚ Ð¶Ðµ GTID, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð±Ñ‹Ð» Ð½Ð°Ð·Ð½Ð°Ñ‡ÐµÐ½ Ñ‚Ñ€Ð°Ð½Ð·Ð°ÐºÑ†Ð¸Ð¸ Ð½Ð° Ð¸ÑÑ…Ð¾Ð´Ð½Ð¾Ð¼ ÑÐµÑ€Ð²ÐµÑ€Ðµ. 

Ð”Ð»Ñ master Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» `/etc/my.cnf`:
```
[mysqld]
bind-address = 192.168.11.150

gtid_mode=ON
enforce-gtid-consistency

server-id = 1

log_bin = mysql-bin
log-error=/var/log/mysqld.log

replicate-do-db=bet
replicate-do-table=bet.bookmaker
replicate-do-table=bet.competition
replicate-do-table=bet.market
replicate-do-table=bet.odds
replicate-do-table=bet.outcome
```
ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸:

`bind-address`                        - Ð°Ð´Ñ€ÐµÑ, Ð½Ð° ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ð±ÑƒÐ´ÐµÑ‚ ÑÐ»ÑƒÑˆÐ°Ñ‚ÑŒ MySQL

`gtid_mode=ON
 enforce-gtid-consistency`            - Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ GTID
 
`server-id`                           - Ð¿Ð¾Ñ€ÑÐ´ÐºÐ¾Ð²Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€ ÑÐµÑ€Ð²ÐµÑ€Ð°, Ð´Ð»Ñ master =1

`log_bin`                             - Ð°ÐºÑ‚Ð¸Ð²Ð°Ñ†Ð¸Ñ Ñ€ÐµÐ¶Ð¸Ð¼Ð° Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¿Ñ€Ð¸ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸

`replicate-do-db, replicate-do-table` - Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÑ‚ Ð‘Ð” Ð¸ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð´Ð»Ñ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸

ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ MySQL:
``` 
sudo systemctl restart mysqld 
```
Ð¡Ð¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ Ð´Ð»Ñ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð¸ Ð´Ð°Ð´Ð¸Ð¼ ÐµÐ¼Ñƒ Ð¿Ñ€Ð°Ð²Ð° Ð½Ð° Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸ÑŽ:
```
CREATE USER 'replication_user'@'192.168.11.151' IDENTIFIED BY 'Replication2022#';
GRANT REPLICATION SLAVE ON *.* TO 'replication_user'@'192.168.11.151';
```
Ð¡Ð¾Ð·Ð´Ð°Ð´Ð¸Ð¼ Ð±Ð°Ð·Ñƒ Ð´Ð°Ð½Ð½Ñ‹Ñ… `bet`, Ð·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð´Ð°Ð¼Ð¿Ð° Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼:
```
Last login: Tue Jan 25 07:09:08 2022 from 10.0.2.2
[vagrant@master ~]$ sudo su
[root@master vagrant]# mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 5
Server version: 5.7.37-log MySQL Community Server (GPL)

Copyright (c) 2000, 2022, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> SHOW MASTER STATUS;
+------------------+----------+--------------+------------------+-------------------------------------------+
| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                         |
+------------------+----------+--------------+------------------+-------------------------------------------+
| mysql-bin.000002 |      464 |              |                  | 6ece991b-7da7-11ec-9473-5254004d77d3:1-39 |
+------------------+----------+--------------+------------------+-------------------------------------------+
1 row in set (0.01 sec)

mysql> SHOW BINARY LOGS;
+------------------+-----------+
| Log_name         | File_size |
+------------------+-----------+
| mysql-bin.000001 |     92744 |
| mysql-bin.000002 |       464 |
+------------------+-----------+
2 rows in set (0.01 sec)
```

***ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° REPLICA***

Ð”Ð»Ñ replica Ð½Ð°ÑÑ‚Ñ€Ð°Ð¸Ð²Ð°ÐµÐ¼ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ð¾Ð½Ð½Ñ‹Ð¹ Ñ„Ð°Ð¹Ð» `/etc/my.cnf`, Ð¼ÐµÐ½ÑÑ Ð¿Ð¾Ñ€ÑÐ´ÐºÐ¾Ð²Ñ‹Ð¹ Ð½Ð¾Ð¼ÐµÑ€ ÑÐµÑ€Ð²ÐµÑ€Ð° `server-id = 2`:
```
[mysqld]
bind-address = 192.168.11.151

gtid_mode=ON
enforce-gtid-consistency

server-id = 2
```
ÐŸÐµÑ€ÐµÐ·Ð°Ð³Ñ€ÑƒÐ¶Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ MySQL:
``` 
sudo systemctl restart mysqld 
```
ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ð¼ ÑÐµÑ€Ð²ÐµÑ€ Ð² Ñ€ÐµÐ¶Ð¸Ð¼ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ¸:
```
CHANGE MASTER TO MASTER_HOST="192.168.11.150", MASTER_PORT = 3306, MASTER_USER="replication_user", MASTER_PASSWORD="Replication2022#", MASTER_AUTO_POSITION=1;'
START SLAVE;
```
ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼:
```
SHOW SLAVE STATUS\G;
*************************** 1. row ***************************
               Slave_IO_State: Waiting for master to send event
                  Master_Host: 192.168.11.150
                  Master_User: replication_user
                  Master_Port: 3306
                Connect_Retry: 60
              Master_Log_File: mysql-bin.000002
          Read_Master_Log_Pos: 194
               Relay_Log_File: replica-relay-bin.000005
                Relay_Log_Pos: 407
        Relay_Master_Log_File: mysql-bin.000002
             Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB: 
          Replicate_Ignore_DB: 
           Replicate_Do_Table: 
       Replicate_Ignore_Table: 
      Replicate_Wild_Do_Table: 
  Replicate_Wild_Ignore_Table: 
                   Last_Errno: 0
                   Last_Error: 
                 Skip_Counter: 0
          Exec_Master_Log_Pos: 194
              Relay_Log_Space: 656
              Until_Condition: None
               Until_Log_File: 
                Until_Log_Pos: 0
           Master_SSL_Allowed: No
           Master_SSL_CA_File: 
           Master_SSL_CA_Path: 
              Master_SSL_Cert: 
            Master_SSL_Cipher: 
               Master_SSL_Key: 
        Seconds_Behind_Master: 0
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: 0
                Last_IO_Error: 
               Last_SQL_Errno: 0
               Last_SQL_Error: 
  Replicate_Ignore_Server_Ids: 
             Master_Server_Id: 1
                  Master_UUID: 6ece991b-7da7-11ec-9473-5254004d77d3
             Master_Info_File: /var/lib/mysql/master.info
                    SQL_Delay: 0
          SQL_Remaining_Delay: NULL
      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates
           Master_Retry_Count: 86400
                  Master_Bind: 
      Last_IO_Error_Timestamp: 
     Last_SQL_Error_Timestamp: 
               Master_SSL_Crl: 
           Master_SSL_Crlpath: 
           Retrieved_Gtid_Set: 6ece991b-7da7-11ec-9473-5254004d77d3:1-38
            Executed_Gtid_Set: 6ece991b-7da7-11ec-9473-5254004d77d3:1-38
                Auto_Position: 1
         Replicate_Rewrite_DB: 
                 Channel_Name: 
           Master_TLS_Version: 
1 row in set (0.01 sec)
```

ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ Ñ€ÐµÐ¿Ð»Ð¸ÐºÐ°Ñ†Ð¸Ð¸. ÐÐ° Ð¼Ð°ÑÑ‚ÐµÑ€Ðµ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð·Ð°Ð¿Ð¸ÑÑŒ Ð² Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñƒ:
```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| bet                |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.04 sec)

mysql> use bet
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+------------------+
| Tables_in_bet    |
+------------------+
| bookmaker        |
| competition      |
| events_on_demand |
| market           |
| odds             |
| outcome          |
| v_same_event     |
+------------------+
7 rows in set (0.01 sec)

mysql> select * from bookmaker
    -> ;
+----+----------------+
| id | bookmaker_name |
+----+----------------+
|  4 | betway         |
|  5 | bwin           |
|  6 | ladbrokes      |
|  3 | unibet         |
+----+----------------+
4 rows in set (0.01 sec)

mysql> INSERT INTO bookmaker (id,bookmaker_name) VALUES(10,'books');
Query OK, 1 row affected (0.04 sec)

mysql> select * from bookmaker;
+----+----------------+
| id | bookmaker_name |
+----+----------------+
|  4 | betway         |
| 10 | books          |
|  5 | bwin           |
|  6 | ladbrokes      |
|  3 | unibet         |
+----+----------------+
5 rows in set (0.00 sec)
```
ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð° Ñ€ÐµÐ¿Ð»Ð¸ÐºÐµ:
```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| bet                |
| mysql              |
| performance_schema |
| sys                |
+--------------------+
5 rows in set (0.03 sec)

mysql> use bet;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> show tables;
+------------------+
| Tables_in_bet    |
+------------------+
| bookmaker        |
| competition      |
| events_on_demand |
| market           |
| odds             |
| outcome          |
| v_same_event     |
+------------------+
7 rows in set (0.01 sec)

mysql> select * from bookmaker;
+----+----------------+
| id | bookmaker_name |
+----+----------------+
|  4 | betway         |
| 10 | books          |
|  5 | bwin           |
|  6 | ladbrokes      |
|  3 | unibet         |
+----+----------------+
5 rows in set (0.00 sec)
```


