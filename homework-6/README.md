# **–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ6**

üîñ–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –¥–ª—è –∫—É—Ä—Å–∞ [Administrator Linux.Professional](https://otus.ru/lessons/linux-professional/)

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

- **VirtualBox** - —Å—Ä–µ–¥–∞ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏, –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã;
- **Vagrant** - –ü–û –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥—ã. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å—Ä–µ–¥—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è *VirtualBox*; (https://www.vagrantup.com/downloads.html);

# **–¶–µ–ª—å**
 
## **–°–æ–±—Ä–∞—Ç—å —Å–≤–æ–π RPM –ø–∞–∫–µ—Ç –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å –µ–≥–æ –≤ —Å–≤–æ–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**
 
- —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π RPM;
- —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ç–∞–º —Å–≤–æ–π RPM;
- —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —ç—Ç–æ –≤—Å–µ –≤ Vagrant.

# **–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**

–°—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–æ–µ–∫—Ç https://github.com/MsyuLuch/LinuxProfessional/tree/main/homework-6

–ó–¥–µ—Å—å:
- `readme.md` - –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è
- `Vagrantfile` - —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è `Vagrant`
- `build.sh` - —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ –ø–∞–∫–µ—Ç–∞ –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- `nginx.spec` - –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π spec-—Ñ–∞–π–ª

–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞:
1. –ü–æ–¥–Ω–∏–º–∞–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É. 
2. –ú–µ–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ root. 
3. –ò–∑ –¥–æ–º–∞—à–Ω–µ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞ root –∑–∞–ø—É—Å–∫–∞–µ–º —Å–∫—Ä–∏–ø—Ç build.sh.

# **–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è ‚Ññ6**
–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞:
```
yum install -y \
redhat-lsb-core \
wget \
rpmdevtools \
rpm-build \
createrepo \
yum-utils \
openssl-devel \
zlib-devel \ 
pcre-devel
```

–°–∫–∞—á–∏–≤–∞–µ–º –∏ —Ä–∞–∑–∞—Ä—Ö–∏–≤–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ `openssl`:
```
wget https://www.openssl.org/source/latest.tar.gz && tar -xvf latest.tar.gz
```

–ü–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ–º –¥–µ—Ä–µ–≤–æ –∫–∞—Ç–∞–ª–æ–≥–æ–≤ –¥–ª—è —Å–±–æ—Ä–∫–∏ –ø–∞–∫–µ—Ç–∞ –≤ –¥–æ–º–∞—à–Ω–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```
rpmdev-setuptree
```

–°–∫–∞—á–∏–≤–∞–µ–º src-–ø–∞–∫–µ—Ç–∞ NGINX –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º.

–î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ –≤–≤–æ–¥–∏–º –∫–æ–º–∞–Ω–¥—É:
  `rpm -Uvh <–ø—É—Ç—å –¥–æ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞>`:
  
  U ‚Äî –æ–±–Ω–æ–≤–∏—Ç—å, –µ—Å–ª–∏ –ø–∞–∫–µ—Ç —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ —Å–∏—Å—Ç–µ–º–µ.
  
  v ‚Äî –≤—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ö–æ–¥–µ –ø—Ä–æ—Ü–µ—Å—Å–∞.
  
  h ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏.
```
wget https://nginx.org/packages/centos/7/SRPMS/nginx-1.14.1-1.el7_4.ngx.src.rpm \
&& rpm -Uvh nginx-1.14.1-1.el7_4.ngx.src.rpm
```

–ó–∞–º–µ–Ω–∏–º spec —Ñ–∞–π–ª –Ω–∞ —Å–≤–æ–π –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π:
```
wget https://raw.githubusercontent.com/MsyuLuch/LinuxProfessional/main/homework-6/nginx.spec \
&& mv -f nginx.spec rpmbuild/SPECS/nginx.spec
```

–°–æ–±–∏—Ä–∞–µ–º —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–π RPM-–ø–∞–∫–µ—Ç:
```
rpmbuild -bb rpmbuild/SPECS/nginx.spec
```

–£—Å—Ç–∞–Ω–æ–≤–∏–º —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç:
```
yum localinstall -y rpmbuild/RPMS/x86_64/nginx-1.14.1-1.el7_4.ngx.x86_64.rpm
```

–ó–∞–ø—É—Å–∫–∞–µ–º nginx –∏ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ –∞–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫—É:
```
systemctl start nginx && systemctl enable nginx
```

–°–æ–∑–¥–∞–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –≥–¥–µ –±—É–¥–µ—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –Ω–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–Ω–æ—Å–∏–º –≤ –Ω–µ—ë —Å–æ–±—Ä–∞–Ω–Ω—ã–π –ø–∞–∫–µ—Ç NGINX:
```
mkdir /usr/share/nginx/html/repo \
&& cp rpmbuild/RPMS/x86_64/nginx-1.14.1-1.el7_4.ngx.x86_64.rpm /usr/share/nginx/html/repo/
```

–í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–º–∞–Ω–¥—É —Å–æ–∑–¥–∞–Ω–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –≤ —Å–æ–∑–¥–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
```
createrepo /usr/share/nginx/html/repo/
```

–î–æ–±–∞–≤–ª—è–µ–º –≤ –∫–æ–Ω—Ñ–∏–≥ —Ñ–∞–π–ª NGINX —Å—Ç—Ä–æ–∫—É `autoindex on;` –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º NGINX:
```
sed -i 's/location \/ {/location \/ {\n autoindex on;/g' /etc/nginx/conf.d/default.conf
nginx -s reload
```

–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é:
```
curl -a http://localhost/repo/
```

–î–æ–±–∞–≤–ª—è–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ –Ω–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º –µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥–æ–π `yum repolist enabled`:
```
cat >> /etc/yum.repos.d/otus.repo << EOF
[otus]
name=otus-linux
baseurl=http://localhost/repo
gpgcheck=0
enabled=1
EOF

yum repolist enabled | grep otus
```



